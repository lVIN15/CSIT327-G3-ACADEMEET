{% extends 'base.html' %}
{% load static %}

{% block title %}Password Reset Email Sent - Academeet{% endblock %}

{% block content %}
    <div class="bg-shape"></div>
    <div class="bg-shape"></div>
    <div class="bg-shape"></div>

    <a href="{% url 'role_selection' %}" class="back-link">‚Üê Back</a>

    <div class="container">
        <div class="logo">
            <div class="logo-icon">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 2L2 7v10c0 5.55 3.84 9.74 9 11 5.16-1.26 9-5.45 9-11V7l-10-5z"/>
                    <path d="M9 12l2 2 4-4"/>
                </svg>
            </div>
            <h1>Email Sent</h1>
            <p class="subtitle">Password reset link sent to your email</p>
        </div>

        <div class="signup-form-container">
            <h2 class="form-title">We've Sent A Request Reset Link to Your Email</h2>
            <p class="note">Please check the email inbox you signed up with{% if email %} ({{ email }}){% endif %}. You may need to check the Spam folder.</p>

            <form method="post" action="" class="signup-form">
                {% csrf_token %}
                {% if email %}<input type="hidden" name="email" value="{{ email }}">{% endif %}
                <button id="resendBtn" class="login-btn" type="submit">Resend request</button>
            </form>

            <div class="register-link">
                <p><a href="{% url 'role_selection' %}">Back to role selection</a></p>
            </div>
        </div>
    </div>
<script>
(function(){
  var remaining = {{ cooldown_remaining|default:0 }};
  var btn = document.getElementById('resendBtn');
  var timer = null;
  
  function render(){
    if(!btn) return;
    if(remaining > 0){
      btn.disabled = true;
      var m = Math.floor(remaining/60);
      var s = remaining % 60;
      btn.textContent = 'Resend email in ' + m + ':' + (s<10?'0'+s:s);
    } else {
      btn.disabled = false;
      btn.textContent = 'Resend email';
    }
  }
  
  function startTimer() {
    if(timer) clearInterval(timer);
    timer = setInterval(function(){
      remaining -= 1;
      render();
      if(remaining <= 0){ 
        clearInterval(timer);
        timer = null;
      }
    }, 1000);
  }
  
  // Start timer if there's remaining time
  if(remaining > 0){
    startTimer();
  } else {
    render();
  }
  
  // Reset timer when form is submitted (new request)
  var form = document.querySelector('form');
  if(form) {
    form.addEventListener('submit', function() {
      // Clear any existing timer
      if(timer) {
        clearInterval(timer);
        timer = null;
      }
      remaining = 90; // Reset to full 90 seconds
      startTimer();
    });
  }
})();
</script>
{% endblock %}
